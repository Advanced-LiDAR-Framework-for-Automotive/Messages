# **ALFA-Messages**

<p align="center">
<img src="imgs/ALFA_Message.svg" alt="message" width="300" />
</p>

ALFA-Messages is a generic package that only contains the message and service types used in an ALFA environment. Thus every ALFA Node requires this package to compile. This is also applicable to ROS Nodes generated by Yocto recipes.

# **Dependencies**

Currently, ALFA-Messages was only tested using the operating system [Ubuntu 18.04](https://releases.ubuntu.com/18.04/), be aware that for other operative systems, this version may not work. Additionally, ALFA-Messages was developed using the ROS Melodic version, and other ROS versions may not work.

## **ROS**

ALFA-Messages uses ROS as it's core to communicate, and gather information. Thus, to compile it, ROS is needed.

Execute the following commands in a terminal:

```sh
sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
```

```sh
sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
```

```sh
sudo apt update
```

```sh
sudo apt install ros-melodic-desktop-full
```

```sh
echo "source /opt/ros/melodic/setup.bash" >> ~/.bashrc
```

```sh
source ~/.bashrc
```


# **ROS environment**

To compile ALFA-Messages, the source code needs to be in a ROS environment, to create one just execute the following commands in a terminal:

```sh
mkdir -p ~/catkin_ws/src
```

```sh
cd ~/catkin_ws/
```

```sh
source /opt/ros/melodic/setup.bash
```

```sh
catkin_make
```

# **Compilation**

To compile just execute the following command in the ROS environment directory, in this case, the catkin_ws directory.

```sh
source /opt/ros/melodic/setup.bash
```

```sh
catkin_make
```

# **Message types**

ALFA-Messages defines a couple of message types that are used in node-monitor communication. 

## **MetricMessage**

The *MetricMessage* type defines metrics that the ALFA-Monitor reads and displays. These metrics are commonly used to send performance values related to the node execution. It is comprised of a name, a value, which is always a float, and the representation units.

```c
string metric_name
float metric
string units
```

## **ConfigMessage**

The *ConfigMessage* type defines what is a configuration. These configurations are then used by the service call to configure a node. The configuration comprised a name, and the config value represented as a float.

```c
string config_name
float config
```

## **AlfaMetrics**

The AlfaMetrics message type is used to send a group of MetricMessages. A message tag and a vector of MetricMessage define this message type. 

```c
string message_tag
MetricMessage[] metrics
```

## **AlfaAlivePing**



```c
string node_name
string node_type
string config_service_name
int8 current_status
string config_tag
ConfigMessage[] default_configurations
```

# **Service types**

## **AlfaConfigure**

```c
string configutation_tag
ConfigMessage[] configurations
---
int return_status
```

# **Node topology**
